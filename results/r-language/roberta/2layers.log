arguments:
Namespace(max_length=64, batch_size=32, m=0.7, nb_epochs=10, bert_init='roberta-base', pretrained_bert_ckpt='roberta_SATD/checkpoint.pth', dataset='SATD', checkpoint_dir='roberta_gcn_SATD', gcn_model='gcn', gcn_layers=2, n_hidden=200, heads=8, dropout=0.5, gcn_lr=0.001, bert_lr=1e-05)
checkpoints will be saved in roberta_gcn_SATD
graph information:
Graph(num_nodes=6800, num_edges=242658,
      ndata_schemes={'input_ids': Scheme(shape=(64,), dtype=torch.int64), 'attention_mask': Scheme(shape=(64,), dtype=torch.int64), 'label': Scheme(shape=(), dtype=torch.int64), 'train': Scheme(shape=(), dtype=torch.float32), 'val': Scheme(shape=(), dtype=torch.float32), 'test': Scheme(shape=(), dtype=torch.float32), 'label_train': Scheme(shape=(), dtype=torch.int64), 'cls_feats': Scheme(shape=(768,), dtype=torch.float32)}
      edata_schemes={'edge_weight': Scheme(shape=(), dtype=torch.float32)})
Epoch: 1  Train acc: 0.7075 loss: 0.7650  Val acc: 0.6132 loss: 1.2842  Test acc: 0.5982 loss: 1.3335
{"0": {"precision": 0.21052631578947367, "recall": 0.15384615384615385, "f1-score": 0.17777777777777728}, "1": {"precision": 0.4745762711864407, "recall": 0.4375, "f1-score": 0.45528455284552793}, "2": {"precision": 0.42857142857142855, "recall": 0.10344827586206896, "f1-score": 0.16666666666666632}, "3": {"precision": 0.5779661016949152, "recall": 0.8589420654911839, "f1-score": 0.6909827760891586}, "4": {"precision": 0.7719298245614035, "recall": 0.2894736842105263, "f1-score": 0.42105263157894696}, "5": {"precision": 0.5238095238095238, "recall": 0.36666666666666664, "f1-score": 0.43137254901960737}, "6": {"precision": 1.0, "recall": 0.09090909090909091, "f1-score": 0.16666666666666652}, "7": {"precision": 0.0, "recall": 0.0, "f1-score": 0.0}, "8": {"precision": 0.5588235294117647, "recall": 0.24050632911392406, "f1-score": 0.33628318584070754}, "9": {"precision": 0.7556818181818182, "recall": 0.875, "f1-score": 0.810975609756097}, "10": {"precision": 0.0, "recall": 0.0, "f1-score": 0.0}, "11": {"precision": 0.0, "recall": 0.0, "f1-score": 0.0}, "macro avg": {"precision": 0.4418237344338974, "recall": 0.2846910221749679, "f1-score": 0.30475520135342965}}
New checkpoint
Epoch: 2  Train acc: 0.7615 loss: 0.6475  Val acc: 0.6489 loss: 1.2217  Test acc: 0.6205 loss: 1.2929
{"0": {"precision": 0.2777777777777778, "recall": 0.19230769230769232, "f1-score": 0.22727272727272682}, "1": {"precision": 0.8387096774193549, "recall": 0.40625, "f1-score": 0.5473684210526311}, "2": {"precision": 0.5714285714285714, "recall": 0.5517241379310345, "f1-score": 0.5614035087719293}, "3": {"precision": 0.632016632016632, "recall": 0.7657430730478589, "f1-score": 0.6924829157175393}, "4": {"precision": 0.4519774011299435, "recall": 0.5263157894736842, "f1-score": 0.48632218844984754}, "5": {"precision": 0.5172413793103449, "recall": 0.5, "f1-score": 0.508474576271186}, "6": {"precision": 1.0, "recall": 0.2727272727272727, "f1-score": 0.42857142857142816}, "7": {"precision": 0.0, "recall": 0.0, "f1-score": 0.0}, "8": {"precision": 0.5952380952380952, "recall": 0.31645569620253167, "f1-score": 0.41322314049586734}, "9": {"precision": 0.8451612903225807, "recall": 0.8618421052631579, "f1-score": 0.8534201954397388}, "10": {"precision": 0.0, "recall": 0.0, "f1-score": 0.0}, "11": {"precision": 0.0, "recall": 0.0, "f1-score": 0.0}, "macro avg": {"precision": 0.477462568720275, "recall": 0.36611381391276937, "f1-score": 0.3932115918369079}}
New checkpoint
Epoch: 3  Train acc: 0.7901 loss: 0.5633  Val acc: 0.6539 loss: 1.2114  Test acc: 0.6297 loss: 1.2789
{"0": {"precision": 0.3, "recall": 0.17307692307692307, "f1-score": 0.21951219512195075}, "1": {"precision": 0.7435897435897436, "recall": 0.453125, "f1-score": 0.5631067961165044}, "2": {"precision": 0.8, "recall": 0.41379310344827586, "f1-score": 0.545454545454545}, "3": {"precision": 0.6455696202531646, "recall": 0.7707808564231738, "f1-score": 0.7026406429391499}, "4": {"precision": 0.47093023255813954, "recall": 0.5328947368421053, "f1-score": 0.49999999999999944}, "5": {"precision": 0.56, "recall": 0.4666666666666667, "f1-score": 0.5090909090909085}, "6": {"precision": 0.7142857142857143, "recall": 0.45454545454545453, "f1-score": 0.555555555555555}, "7": {"precision": 0.0, "recall": 0.0, "f1-score": 0.0}, "8": {"precision": 0.5081967213114754, "recall": 0.3924050632911392, "f1-score": 0.44285714285714234}, "9": {"precision": 0.825, "recall": 0.868421052631579, "f1-score": 0.8461538461538456}, "10": {"precision": 0.0, "recall": 0.0, "f1-score": 0.0}, "11": {"precision": 0.0, "recall": 0.0, "f1-score": 0.0}, "macro avg": {"precision": 0.4639643359998531, "recall": 0.3771424047437764, "f1-score": 0.40703096944080003}}
New checkpoint
Epoch: 4  Train acc: 0.8025 loss: 0.5055  Val acc: 0.6565 loss: 1.2442  Test acc: 0.6287 loss: 1.3123
{"0": {"precision": 0.2641509433962264, "recall": 0.2692307692307692, "f1-score": 0.26666666666666616}, "1": {"precision": 0.8285714285714286, "recall": 0.453125, "f1-score": 0.5858585858585853}, "2": {"precision": 0.625, "recall": 0.5172413793103449, "f1-score": 0.5660377358490561}, "3": {"precision": 0.6494623655913978, "recall": 0.760705289672544, "f1-score": 0.7006960556844543}, "4": {"precision": 0.5031055900621118, "recall": 0.5328947368421053, "f1-score": 0.517571884984025}, "5": {"precision": 0.42857142857142855, "recall": 0.5, "f1-score": 0.461538461538461}, "6": {"precision": 0.8333333333333334, "recall": 0.45454545454545453, "f1-score": 0.5882352941176465}, "7": {"precision": 0.0, "recall": 0.0, "f1-score": 0.0}, "8": {"precision": 0.5681818181818182, "recall": 0.31645569620253167, "f1-score": 0.40650406504064995}, "9": {"precision": 0.825, "recall": 0.868421052631579, "f1-score": 0.8461538461538456}, "10": {"precision": 0.0, "recall": 0.0, "f1-score": 0.0}, "11": {"precision": 0.0, "recall": 0.0, "f1-score": 0.0}, "macro avg": {"precision": 0.4604480756423121, "recall": 0.38938494820294406, "f1-score": 0.4116052163244492}}
New checkpoint
Epoch: 5  Train acc: 0.8090 loss: 0.4597  Val acc: 0.6463 loss: 1.3236  Test acc: 0.6429 loss: 1.3693
{"0": {"precision": 0.2222222222222222, "recall": 0.15384615384615385, "f1-score": 0.18181818181818135}, "1": {"precision": 0.725, "recall": 0.453125, "f1-score": 0.557692307692307}, "2": {"precision": 0.6296296296296297, "recall": 0.5862068965517241, "f1-score": 0.6071428571428565}, "3": {"precision": 0.6377952755905512, "recall": 0.8161209068010076, "f1-score": 0.7160220994475132}, "4": {"precision": 0.717391304347826, "recall": 0.4342105263157895, "f1-score": 0.5409836065573765}, "5": {"precision": 0.4838709677419355, "recall": 0.5, "f1-score": 0.4918032786885241}, "6": {"precision": 0.6, "recall": 0.5454545454545454, "f1-score": 0.5714285714285707}, "7": {"precision": 0.0, "recall": 0.0, "f1-score": 0.0}, "8": {"precision": 0.425, "recall": 0.43037974683544306, "f1-score": 0.4276729559748423}, "9": {"precision": 0.8364779874213837, "recall": 0.875, "f1-score": 0.8553054662379416}, "10": {"precision": 0.0, "recall": 0.0, "f1-score": 0.0}, "11": {"precision": 0.0, "recall": 0.0, "f1-score": 0.0}, "macro avg": {"precision": 0.43978228224612903, "recall": 0.39952864798372195, "f1-score": 0.4124891104156761}}
Epoch: 6  Train acc: 0.8146 loss: 0.4202  Val acc: 0.6514 loss: 1.3852  Test acc: 0.6348 loss: 1.4541
{"0": {"precision": 0.23809523809523808, "recall": 0.19230769230769232, "f1-score": 0.21276595744680799}, "1": {"precision": 0.7073170731707317, "recall": 0.453125, "f1-score": 0.5523809523809519}, "2": {"precision": 0.75, "recall": 0.41379310344827586, "f1-score": 0.5333333333333329}, "3": {"precision": 0.6192307692307693, "recall": 0.8110831234256927, "f1-score": 0.7022900763358774}, "4": {"precision": 0.6355140186915887, "recall": 0.4473684210526316, "f1-score": 0.5250965250965246}, "5": {"precision": 0.45714285714285713, "recall": 0.5333333333333333, "f1-score": 0.4923076923076918}, "6": {"precision": 0.5454545454545454, "recall": 0.5454545454545454, "f1-score": 0.5454545454545449}, "7": {"precision": 0.0, "recall": 0.0, "f1-score": 0.0}, "8": {"precision": 0.5576923076923077, "recall": 0.3670886075949367, "f1-score": 0.442748091603053}, "9": {"precision": 0.8301886792452831, "recall": 0.868421052631579, "f1-score": 0.8488745980707391}, "10": {"precision": 0.0, "recall": 0.0, "f1-score": 0.0}, "11": {"precision": 0.0, "recall": 0.0, "f1-score": 0.0}, "macro avg": {"precision": 0.44505295739361017, "recall": 0.38599790660405725, "f1-score": 0.40460431433579364}}
Epoch: 7  Train acc: 0.8353 loss: 0.4229  Val acc: 0.6260 loss: 1.4148  Test acc: 0.6175 loss: 1.4906
{"0": {"precision": 0.25, "recall": 0.2692307692307692, "f1-score": 0.2592592592592588}, "1": {"precision": 0.7941176470588235, "recall": 0.421875, "f1-score": 0.5510204081632649}, "2": {"precision": 0.64, "recall": 0.5517241379310345, "f1-score": 0.5925925925925921}, "3": {"precision": 0.700507614213198, "recall": 0.6952141057934509, "f1-score": 0.6978508217446264}, "4": {"precision": 0.4725274725274725, "recall": 0.5657894736842105, "f1-score": 0.5149700598802389}, "5": {"precision": 0.3275862068965517, "recall": 0.6333333333333333, "f1-score": 0.4318181818181813}, "6": {"precision": 0.5, "recall": 0.5454545454545454, "f1-score": 0.521739130434782}, "7": {"precision": 0.0, "recall": 0.0, "f1-score": 0.0}, "8": {"precision": 0.5283018867924528, "recall": 0.35443037974683544, "f1-score": 0.42424242424242375}, "9": {"precision": 0.8012048192771084, "recall": 0.875, "f1-score": 0.836477987421383}, "10": {"precision": 0.6666666666666666, "recall": 0.2857142857142857, "f1-score": 0.3999999999999996}, "11": {"precision": 0.0, "recall": 0.0, "f1-score": 0.0}, "macro avg": {"precision": 0.4734093594526894, "recall": 0.4331471692407054, "f1-score": 0.43583090546306263}}
Epoch: 8  Train acc: 0.8412 loss: 0.3846  Val acc: 0.6285 loss: 1.4630  Test acc: 0.6338 loss: 1.4960
{"0": {"precision": 0.2857142857142857, "recall": 0.3076923076923077, "f1-score": 0.29629629629629584}, "1": {"precision": 0.7441860465116279, "recall": 0.5, "f1-score": 0.5981308411214948}, "2": {"precision": 0.5483870967741935, "recall": 0.5862068965517241, "f1-score": 0.566666666666666}, "3": {"precision": 0.6666666666666666, "recall": 0.7455919395465995, "f1-score": 0.7039239001189055}, "4": {"precision": 0.5094339622641509, "recall": 0.5328947368421053, "f1-score": 0.5209003215434078}, "5": {"precision": 0.5, "recall": 0.4666666666666667, "f1-score": 0.4827586206896547}, "6": {"precision": 0.5454545454545454, "recall": 0.5454545454545454, "f1-score": 0.5454545454545449}, "7": {"precision": 0.0, "recall": 0.0, "f1-score": 0.0}, "8": {"precision": 0.5625, "recall": 0.34177215189873417, "f1-score": 0.4251968503937003}, "9": {"precision": 0.8209876543209876, "recall": 0.875, "f1-score": 0.8471337579617829}, "10": {"precision": 1.0, "recall": 0.14285714285714285, "f1-score": 0.24999999999999975}, "11": {"precision": 0.0, "recall": 0.0, "f1-score": 0.0}, "macro avg": {"precision": 0.5152775214755382, "recall": 0.42034469895915216, "f1-score": 0.4363718166872044}}
Epoch: 9  Train acc: 0.8624 loss: 0.3547  Val acc: 0.6285 loss: 1.5006  Test acc: 0.6348 loss: 1.5113
{"0": {"precision": 0.2833333333333333, "recall": 0.3269230769230769, "f1-score": 0.30357142857142805}, "1": {"precision": 0.6666666666666666, "recall": 0.53125, "f1-score": 0.5913043478260864}, "2": {"precision": 0.5714285714285714, "recall": 0.5517241379310345, "f1-score": 0.5614035087719293}, "3": {"precision": 0.6872037914691943, "recall": 0.7304785894206549, "f1-score": 0.7081807081807077}, "4": {"precision": 0.5298013245033113, "recall": 0.5263157894736842, "f1-score": 0.5280528052805276}, "5": {"precision": 0.5161290322580645, "recall": 0.5333333333333333, "f1-score": 0.5245901639344257}, "6": {"precision": 0.6, "recall": 0.5454545454545454, "f1-score": 0.5714285714285707}, "7": {"precision": 0.0, "recall": 0.0, "f1-score": 0.0}, "8": {"precision": 0.5272727272727272, "recall": 0.3670886075949367, "f1-score": 0.4328358208955219}, "9": {"precision": 0.7758620689655172, "recall": 0.8881578947368421, "f1-score": 0.828220858895705}, "10": {"precision": 1.0, "recall": 0.14285714285714285, "f1-score": 0.24999999999999975}, "11": {"precision": 0.0, "recall": 0.0, "f1-score": 0.0}, "macro avg": {"precision": 0.5131414596581155, "recall": 0.4286319264771043, "f1-score": 0.44163235114874183}}
Epoch: 10  Train acc: 0.8177 loss: 0.3417  Val acc: 0.6438 loss: 1.6171  Test acc: 0.6409 loss: 1.6905
{"0": {"precision": 0.25925925925925924, "recall": 0.1346153846153846, "f1-score": 0.17721518987341725}, "1": {"precision": 0.7435897435897436, "recall": 0.453125, "f1-score": 0.5631067961165044}, "2": {"precision": 0.6363636363636364, "recall": 0.4827586206896552, "f1-score": 0.5490196078431367}, "3": {"precision": 0.6082289803220036, "recall": 0.8564231738035264, "f1-score": 0.7112970711297065}, "4": {"precision": 0.6904761904761905, "recall": 0.3815789473684211, "f1-score": 0.49152542372881314}, "5": {"precision": 0.5833333333333334, "recall": 0.4666666666666667, "f1-score": 0.518518518518518}, "6": {"precision": 0.6, "recall": 0.5454545454545454, "f1-score": 0.5714285714285707}, "7": {"precision": 0.0, "recall": 0.0, "f1-score": 0.0}, "8": {"precision": 0.47540983606557374, "recall": 0.3670886075949367, "f1-score": 0.4142857142857138}, "9": {"precision": 0.8627450980392157, "recall": 0.868421052631579, "f1-score": 0.8655737704918028}, "10": {"precision": 0.25, "recall": 0.14285714285714285, "f1-score": 0.18181818181818135}, "11": {"precision": 0.0, "recall": 0.0, "f1-score": 0.0}, "macro avg": {"precision": 0.475783839787413, "recall": 0.3915824284734881, "f1-score": 0.4203157371028637}}
